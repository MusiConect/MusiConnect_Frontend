import{a as W}from"./chunk-PAUB4K2N.js";import{b as k,d as D,e as N,f as z,g as A,h as R,n as q,p as O,r as U}from"./chunk-TKQ7GRMY.js";import{a as T}from"./chunk-Q4PFRBFB.js";import{Ba as F,F as r,Fa as j,I as u,K as h,Ma as V,O as g,Oa as M,R as d,S as I,T as C,U as n,V as a,W as E,Z as x,da as b,ea as s,fa as f,ga as l,ha as y,ia as v,ja as S,ka as w,la as P,u as p,v as m}from"./chunk-H2FOQYQS.js";function L(i,c){i&1&&(n(0,"div",6),E(1,"div",7),n(2,"p",8),l(3,"Cargando publicaci\xF3n..."),a()())}function G(i,c){if(i&1){let t=x();n(0,"div",6)(1,"p",9),l(2),a(),n(3,"button",10),b("click",function(){p(t);let e=s();return m(e.cancelar())}),l(4," Volver "),a()()}if(i&2){let t=s();r(2),y(t.error)}}function H(i,c){i&1&&(n(0,"p",24),l(1," El contenido es obligatorio. "),a())}function J(i,c){i&1&&(n(0,"span"),l(1,"Actualizar \u{1F4DD}"),a())}function K(i,c){i&1&&(n(0,"span"),l(1,"Actualizando..."),a())}function Q(i,c){if(i&1&&(n(0,"div",25),l(1),a()),i&2){let t=s(2);C(t.mensaje.includes("\u2705")?"text-green-600":"text-red-600"),r(),v(" ",t.mensaje," ")}}function X(i,c){if(i&1){let t=x();n(0,"div",11)(1,"form",12,0),b("ngSubmit",function(){p(t);let e=s();return m(e.actualizar())}),n(3,"div",13)(4,"label",14),l(5,"Contenido"),a(),n(6,"textarea",15,1),P("ngModelChange",function(e){p(t);let _=s();return w(_.contenido,e)||(_.contenido=e),m(e)}),a(),n(8,"div",16),g(9,H,2,0,"p",17),n(10,"span",18),l(11),a()()(),n(12,"div",19)(13,"button",20),b("click",function(){p(t);let e=s();return m(e.cancelar())}),l(14," Cancelar "),a(),n(15,"button",21),g(16,J,2,0,"span",22)(17,K,2,0,"span",22),a()()(),g(18,Q,2,3,"div",23),a()}if(i&2){let t=f(2),o=f(7),e=s();r(),I("opacity-50",e.cargando),r(5),S("ngModel",e.contenido),d("disabled",e.cargando),r(3),d("ngIf",o.invalid&&o.touched),r(2),v("",e.contenido.length,"/500"),r(2),d("disabled",e.cargando),r(2),d("disabled",t.invalid||e.contenido.length>500||e.cargando),r(),d("ngIf",!e.cargando),r(),d("ngIf",e.cargando),r(),d("ngIf",e.mensaje)}}var B=class i{constructor(c,t,o,e){this.postService=c;this.sessionService=t;this.route=o;this.router=e}publicacionId=0;contenido="";mensaje="";cargando=!1;cargandoInicial=!0;error="";ngOnInit(){this.publicacionId=Number(this.route.snapshot.paramMap.get("id")),this.publicacionId?this.cargarPublicacion():(this.error="ID de publicaci\xF3n no v\xE1lido.",this.cargandoInicial=!1)}cargarPublicacion(){this.postService.obtenerPost(this.publicacionId).subscribe({next:c=>{this.contenido=c.contenido,this.cargandoInicial=!1},error:()=>{this.error="Error al cargar la publicaci\xF3n.",this.cargandoInicial=!1}})}actualizar(){if(!this.contenido.trim()){this.mensaje="\u274C El contenido no puede estar vac\xEDo.";return}if(this.contenido.length>500){this.mensaje="\u274C El contenido no puede superar los 500 caracteres.";return}this.cargando=!0;let c=this.sessionService.getUserId()??0,t={contenido:this.contenido.trim(),usuarioId:c};this.postService.editarPost(this.publicacionId,t).subscribe({next:()=>{this.mensaje="\u2705 Publicaci\xF3n actualizada exitosamente.",this.cargando=!1,setTimeout(()=>this.router.navigate(["/publicaciones"]),2e3)},error:o=>{this.mensaje=o.error?.message?`\u274C ${o.error.message}`:"\u274C Error al actualizar la publicaci\xF3n.",this.cargando=!1,setTimeout(()=>this.mensaje="",5e3)}})}cancelar(){this.router.navigate(["/publicaciones"])}static \u0275fac=function(t){return new(t||i)(u(W),u(T),u(V),u(M))};static \u0275cmp=h({type:i,selectors:[["app-editar-publicacion"]],decls:6,vars:3,consts:[["form","ngForm"],["contenidoCtrl","ngModel"],[1,"max-w-4xl","mx-auto","px-6","py-8","font-bree"],[1,"text-3xl","font-black","mb-8"],["class","text-center py-12",4,"ngIf"],["class","bg-white rounded-lg shadow-lg p-6",4,"ngIf"],[1,"text-center","py-12"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-[#FF00FF]"],[1,"mt-4","text-gray-600"],[1,"text-red-600","text-lg"],[1,"mt-4","bg-[#FF00FF]","text-white","px-6","py-2","rounded-lg","hover:bg-pink-600","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-lg","p-6"],["novalidate","",3,"ngSubmit"],[1,"mb-6"],["for","contenido",1,"block","text-lg","font-semibold","mb-2"],["id","contenido","name","contenido","required","","maxlength","500","placeholder","\xBFEn qu\xE9 est\xE1s pensando?","rows","6",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-3","text-lg","resize-none",3,"ngModelChange","ngModel","disabled"],[1,"flex","justify-between","items-center","mt-2"],["class","text-red-600 text-sm",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"flex","gap-4","justify-center"],["type","button",1,"bg-gray-500","text-white","text-xl","font-bold","px-8","py-3","rounded-xl","hover:bg-gray-600","transition-colors","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],["type","submit",1,"bg-[#FF00FF]","text-white","text-xl","font-bold","px-8","py-3","rounded-xl","hover:bg-pink-600","transition-colors","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","mt-6 text-center text-lg font-semibold",3,"class",4,"ngIf"],[1,"text-red-600","text-sm"],[1,"mt-6","text-center","text-lg","font-semibold"]],template:function(t,o){t&1&&(n(0,"div",2)(1,"h1",3),l(2,"Editar publicaci\xF3n"),a(),g(3,L,4,0,"div",4)(4,G,5,1,"div",4)(5,X,19,11,"div",5),a()),t&2&&(r(3),d("ngIf",o.cargandoInicial),r(),d("ngIf",o.error&&!o.cargandoInicial),r(),d("ngIf",!o.cargandoInicial&&!o.error))},dependencies:[j,F,U,R,k,D,N,q,O,A,z],encapsulation:2})};export{B as EditarPublicacionComponent};
