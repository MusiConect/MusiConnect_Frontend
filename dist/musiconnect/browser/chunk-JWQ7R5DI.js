import{a as k}from"./chunk-7OC2QND7.js";import{a as U}from"./chunk-FQDNF3NE.js";import{a as T}from"./chunk-Q4PFRBFB.js";import{Aa as P,B as x,Ba as F,F as s,Fa as V,I as u,K as I,Ma as M,O as p,Oa as O,R as d,T as E,U as n,V as o,W as _,Z as b,da as w,ea as f,fa as C,ga as l,ia as m,sa as y,u as h,v as S,wa as j}from"./chunk-H2FOQYQS.js";function N(r,t){if(r&1){let e=b();n(0,"div",13)(1,"button",14),w("click",function(){h(e);let a=f();return S(a.editarPerfil())}),_(2,"img",15),o()()}}function A(r,t){if(r&1&&(n(0,"span"),l(1),o()),r&2){let e=f(2);E(e.tipoMensaje()==="success"?"text-sm text-green-600 font-medium px-3 py-1 bg-green-100 rounded-md":"text-sm text-red-600 font-medium px-3 py-1 bg-red-100 rounded-md"),s(),m(" ",e.mensajeSeguimiento()," ")}}function L(r,t){if(r&1){let e=b();n(0,"div",16)(1,"div",17)(2,"button",18),w("click",function(){h(e);let a=f();return S(a.seguirUsuario())}),_(3,"img",19),o(),p(4,A,2,3,"span",20),o()()}if(r&2){let e=f();s(4),d("ngIf",e.mensajeSeguimiento())}}function B(r,t){if(r&1&&(n(0,"li"),l(1),o()),r&2){let e=t.$implicit;s(),m(" ",e," ")}}function $(r,t){if(r&1&&(n(0,"li"),l(1),o()),r&2){let e=t.$implicit;s(),m(" ",e," ")}}var R=class r{constructor(t,e,i,a,c){this.route=t;this.userService=e;this.session=i;this.router=a;this.followSvc=c}usuario=x(null);mensajeSeguimiento=x("");tipoMensaje=x("success");esPropio=j(()=>{let t=this.session.getUserId();return t!==null&&this.usuario()?.userId===t});ngOnInit(){let t=this.route.snapshot.paramMap.get("id"),e=t?+t:null;if(!e){this.router.navigate(["/home"]);return}this.userService.getById(e).subscribe({next:i=>this.usuario.set(i),error:i=>{console.error("Error al cargar perfil:",i),i.status===404&&this.router.navigate(["/home"])}})}editarPerfil(){this.esPropio()&&this.router.navigate(["/editar-perfil"])}seguirUsuario(){let t=this.session.getUserId(),e=this.usuario();if(!t||!e)return;let i={followerId:t,followedUserId:e.userId};this.followSvc.crearFollow(i).subscribe({next:a=>{this.tipoMensaje.set("success"),this.mensajeSeguimiento.set(`Ahora sigues a ${e.nombreArtistico||"este usuario"}`),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)},error:a=>{let c=a?.error?.error;if(c&&c.includes("Ya sigues")){let g={followerId:t,followedUserId:e.userId};this.followSvc.eliminarFollow(g).subscribe({next:v=>{this.tipoMensaje.set("error"),this.mensajeSeguimiento.set(`Ya no sigues a ${e.nombreArtistico||"este usuario"}`),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)},error:v=>{let D=v?.error?.error??"Error al dejar de seguir.";this.tipoMensaje.set("error"),this.mensajeSeguimiento.set(D),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)}})}else this.tipoMensaje.set("error"),this.mensajeSeguimiento.set(c??"Error al seguir usuario."),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)}})}get instrumentosLista(){return(this.usuario()?.instrumentos??"").split(",").map(e=>e.trim()).filter(Boolean)}get generosLista(){return(this.usuario()?.generosMusicales??[]).map(e=>typeof e=="string"?e:e.nombre)}get rolNombre(){let t=this.usuario()?.role;return typeof t=="string"?t:t?.name??""}static \u0275fac=function(e){return new(e||r)(u(M),u(U),u(T),u(O),u(k))};static \u0275cmp=I({type:r,selectors:[["app-ver-perfil"]],decls:29,vars:8,consts:[["iconoSeguir",""],[1,"perfil-container","flex","flex-col","md:flex-row","gap-10","p-6","md:p-10","font-bree"],[1,"flex","flex-col","items-center","md:w-1/3"],["src","/FotoPerfil.png","alt","Foto de perfil del usuario",1,"w-56","h-56","object-cover","rounded-md","border"],[1,"mt-4","text-xl","md:text-2xl","font-semibold"],["class","flex gap-6 mt-4",4,"ngIf","ngIfElse"],[1,"flex","gap-4","mt-4","text-sm","md:text-base"],[1,"px-3","py-1","rounded-full","bg-[#D9D9D9]","uppercase"],[1,"md:w-2/3","flex","flex-col","gap-6"],[1,"text-lg","md:text-xl","mb-2"],[1,"bg-[#ECECEC]","rounded","p-4","h-32","overflow-y-auto"],[1,"bg-[#ECECEC]","rounded","p-4","h-32","overflow-y-auto","list-disc","list-inside","space-y-1"],[4,"ngFor","ngForOf"],[1,"flex","gap-6","mt-4"],["aria-label","Editar perfil",3,"click"],["src","/Edit.png","alt","Editar",1,"w-8","h-8","hover:scale-110","transition-transform"],[1,"flex","flex-col","items-center","gap-2","mt-4"],[1,"flex","flex-col","items-center","gap-2"],["aria-label","Seguir usuario",3,"click"],["src","/Follow.png","alt","Seguir",1,"w-10","h-10","hover:scale-110","transition-transform"],[3,"class",4,"ngIf"]],template:function(e,i){if(e&1&&(n(0,"div",1)(1,"section",2),_(2,"img",3),n(3,"h1",4),l(4),o(),p(5,N,3,0,"div",5)(6,L,5,1,"ng-template",null,0,y),n(8,"div",6)(9,"span",7),l(10),o(),n(11,"span",7),l(12),o()()(),n(13,"section",8)(14,"div")(15,"h2",9),l(16,"Descripci\xF3n"),o(),n(17,"p",10),l(18),o()(),n(19,"div")(20,"h2",9),l(21,"Tus g\xE9neros musicales son:"),o(),n(22,"ul",11),p(23,B,2,1,"li",12),o()(),n(24,"div")(25,"h2",9),l(26,"Los instrumentos que dominas son:"),o(),n(27,"ul",11),p(28,$,2,1,"li",12),o()()()()),e&2){let a,c,g,v=C(7);s(4),m(" Nombre Art\xEDstico: ",((a=i.usuario())==null?null:a.nombreArtistico)||"Cargando..."," "),s(),d("ngIf",i.esPropio())("ngIfElse",v),s(5),m(" Estado: ",(c=i.usuario())!=null&&c.disponibilidad?"DISPONIBLE":"NO DISPONIBLE"," "),s(2),m(" Rol: ",i.rolNombre," "),s(6),m(" ",((g=i.usuario())==null?null:g.bio)||"Sin descripci\xF3n."," "),s(5),d("ngForOf",i.generosLista),s(5),d("ngForOf",i.instrumentosLista)}},dependencies:[V,P,F],styles:[".bg-\\__ph-0__[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;height:6px}.bg-\\__ph-0__[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#00000040;border-radius:3px}.bg-\\__ph-0__[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent}"]})};export{R as VerPerfilComponent};
