import{a as L}from"./chunk-PAUB4K2N.js";import{b as F,d as N,e as V,f as D,g as R,h as k,n as q,p as W,r as B}from"./chunk-TKQ7GRMY.js";import{a as T}from"./chunk-Q4PFRBFB.js";import{Ba as I,F as r,Fa as j,I as m,K as x,O as p,Oa as M,R as c,S as C,T as h,U as t,V as n,Z as S,da as _,ea as y,fa as b,ga as s,ia as v,ja as P,ka as E,la as w,u as g,v as f}from"./chunk-H2FOQYQS.js";function z(i,a){i&1&&(t(0,"p",16),s(1," El contenido es obligatorio. "),n())}function A(i,a){i&1&&(t(0,"span"),s(1,"Publicar \u{1F4E8}"),n())}function G(i,a){i&1&&(t(0,"span"),s(1,"Publicando..."),n())}function O(i,a){if(i&1&&(t(0,"div",17),s(1),n()),i&2){let o=y();h(o.mensaje.includes("\u2705")?"text-green-600":"text-red-600"),r(),v(" ",o.mensaje," ")}}var U=class i{constructor(a,o,e){this.postService=a;this.sessionService=o;this.router=e}contenido="";mensaje="";cargando=!1;publicar(){if(!this.contenido.trim()){this.mensaje="\u274C El contenido no puede estar vac\xEDo.";return}if(this.contenido.length>500){this.mensaje="\u274C El contenido no puede superar los 500 caracteres.";return}this.cargando=!0;let a=this.sessionService.getUserId();if(!a){this.mensaje="\u274C Error: Usuario no autenticado.",this.cargando=!1;return}let o={contenido:this.contenido.trim(),tipo:"TEXTO",usuarioId:a};this.postService.crearPost(o).subscribe({next:()=>{this.mensaje="\u2705 Publicaci\xF3n creada exitosamente.",this.contenido="",this.cargando=!1,setTimeout(()=>{this.router.navigate(["/publicaciones"])},1e3)},error:e=>{this.mensaje=e.error?.message?`\u274C ${e.error.message}`:"\u274C Error al crear la publicaci\xF3n.",this.cargando=!1,setTimeout(()=>this.mensaje="",5e3)}})}static \u0275fac=function(o){return new(o||i)(m(L),m(T),m(M))};static \u0275cmp=x({type:i,selectors:[["app-crear-publicacion"]],decls:20,vars:10,consts:[["form","ngForm"],["contenidoCtrl","ngModel"],[1,"max-w-4xl","mx-auto","px-6","py-8","font-bree"],[1,"text-3xl","font-black","mb-8"],[1,"bg-white","rounded-lg","shadow-lg","p-6"],["novalidate","",3,"ngSubmit"],[1,"mb-6"],["for","contenido",1,"block","text-lg","font-semibold","mb-2"],["id","contenido","name","contenido","required","","maxlength","500","placeholder","\xBFEn qu\xE9 est\xE1s pensando?","rows","6",1,"w-full","border","border-gray-300","rounded-lg","px-4","py-3","text-lg","resize-none",3,"ngModelChange","ngModel","disabled"],[1,"flex","justify-between","items-center","mt-2"],["class","text-red-600 text-sm",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"text-center"],["type","submit",1,"bg-[#FF00FF]","text-white","text-xl","font-bold","px-8","py-3","rounded-xl","hover:bg-pink-600","transition-colors","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","mt-6 text-center text-lg font-semibold",3,"class",4,"ngIf"],[1,"text-red-600","text-sm"],[1,"mt-6","text-center","text-lg","font-semibold"]],template:function(o,e){if(o&1){let l=S();t(0,"div",2)(1,"h1",3),s(2,"Crear nueva publicaci\xF3n"),n(),t(3,"div",4)(4,"form",5,0),_("ngSubmit",function(){return g(l),f(e.publicar())}),t(6,"div",6)(7,"label",7),s(8,"Contenido"),n(),t(9,"textarea",8,1),w("ngModelChange",function(u){return g(l),E(e.contenido,u)||(e.contenido=u),f(u)}),n(),t(11,"div",9),p(12,z,2,0,"p",10),t(13,"span",11),s(14),n()()(),t(15,"div",12)(16,"button",13),p(17,A,2,0,"span",14)(18,G,2,0,"span",14),n()()(),p(19,O,2,3,"div",15),n()()}if(o&2){let l=b(5),d=b(10);r(4),C("opacity-50",e.cargando),r(5),P("ngModel",e.contenido),c("disabled",e.cargando),r(3),c("ngIf",d.invalid&&d.touched),r(2),v("",e.contenido.length,"/500"),r(2),c("disabled",l.invalid||e.contenido.length>500||e.cargando),r(),c("ngIf",!e.cargando),r(),c("ngIf",e.cargando),r(),c("ngIf",e.mensaje)}},dependencies:[j,I,B,k,F,N,V,q,W,R,D],encapsulation:2})};export{U as CrearPublicacionComponent};
