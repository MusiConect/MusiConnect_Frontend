import{a as O}from"./chunk-ETROT72L.js";import{b as R,d as P,e as W,f as D,g as B,h as U,n as q,o as z,r as G}from"./chunk-TKQ7GRMY.js";import{a as F}from"./chunk-Q4PFRBFB.js";import{Ba as k,F as c,Fa as V,I as v,K as M,Ma as T,O as g,Oa as N,R as u,Sa as A,T as j,U as e,V as t,W as w,Z as I,da as x,ea as b,fa as f,ga as s,ha as E,ia as L,ja as h,ka as C,la as _,u as m,v as p,w as y,x as S}from"./chunk-H2FOQYQS.js";function J(a,i){if(a&1&&(e(0,"div",24)(1,"span"),s(2),t()()),a&2){let o=b();c(),j(o.tipoMensaje==="success"?"text-sm text-green-600 font-medium px-3 py-1 bg-green-100 rounded-md":"text-sm text-red-600 font-medium px-3 py-1 bg-red-100 rounded-md"),c(),L(" ",o.mensajeAccion," ")}}function K(a,i){if(a&1&&(e(0,"div",25)(1,"div",26),y(),e(2,"svg",27),w(3,"path",28),t()(),S(),e(4,"span",29),s(5),t()()),a&2){let o=b();c(5),E(o.mensaje)}}function Q(a,i){if(a&1&&(e(0,"div",30)(1,"span",31),s(2),t()()),a&2){let o=b();c(2),E(o.mensajeError)}}function X(a,i){a&1&&(e(0,"p",32),s(1," El t\xEDtulo es obligatorio y debe tener al menos 3 caracteres. "),t())}function Y(a,i){a&1&&(e(0,"p",32),s(1," La descripci\xF3n es obligatoria y debe tener al menos 10 caracteres. "),t())}var H=class a{constructor(i,o,n,d){this.route=i;this.convocationService=o;this.session=n;this.router=d}titulo="";descripcion="";fechaLimite="";mensaje="";mensajeError="";sinPropiedad=!1;idConvocatoria;mensajeAccion="";tipoMensaje="success";ngOnInit(){this.idConvocatoria=+(this.route.snapshot.paramMap.get("id")??0),this.cargarConvocatoria()}cargarConvocatoria(){this.convocationService.obtenerPorId(this.idConvocatoria).subscribe({next:i=>{let o=this.session.getNombreArtistico();if(o&&o!==i.creadorNombreArtistico){this.sinPropiedad=!0,this.mensajeError="Esta convocatoria no te pertenece.";return}this.titulo=i.titulo,this.descripcion=i.descripcion,this.fechaLimite=i.fechaLimite},error:i=>{i.status===403?(this.sinPropiedad=!0,this.mensajeError="Esta convocatoria no te pertenece.",this.titulo="",this.descripcion="",this.fechaLimite=""):this.router.navigate(["/listar-convocatorias"])}})}guardar(i){if(i.invalid)return;let o={convocationId:this.idConvocatoria,usuarioId:this.session.getUserId()??0,titulo:this.titulo,descripcion:this.descripcion,fechaLimite:this.fechaLimite};this.convocationService.editarConvocatoria(this.idConvocatoria,o).subscribe({next:()=>{this.mensaje="Convocatoria actualizada correctamente.",setTimeout(()=>this.mensaje="",3e3)},error:()=>{this.mensaje="\u274C Error al actualizar la convocatoria",setTimeout(()=>this.mensaje="",3e3)}})}cancelar(){this.router.navigate(["/listar-convocatorias"])}eliminar(){if(!confirm("\xBFEst\xE1 seguro de eliminar la convocatoria?"))return;let i=this.session.getUserId()??0;this.convocationService.eliminarConvocatoria(this.idConvocatoria,i).subscribe({next:()=>this.router.navigate(["/listar-convocatorias"]),error:()=>{this.tipoMensaje="error",this.mensajeAccion="Error al eliminar convocatoria.",setTimeout(()=>this.mensajeAccion="",3e3)}})}static \u0275fac=function(o){return new(o||a)(v(T),v(O),v(F),v(N))};static \u0275cmp=M({type:a,selectors:[["app-editar-convocatoria"]],decls:35,vars:9,consts:[["form","ngForm"],["tituloCtrl","ngModel"],["descCtrl","ngModel"],["fechaCtrl","ngModel"],[1,"max-w-7xl","mx-auto","px-6","py-12","grid","grid-cols-1","md:grid-cols-3","gap-8","font-bree"],[1,"md:col-span-2","space-y-10"],[1,"text-4xl","font-black"],["class","mb-4 flex justify-center",4,"ngIf"],["class","bg-pinkfigma rounded-xl p-4 px-6 mb-8 flex items-center w-full md:w-[500px]",4,"ngIf"],["class","bg-red-200 rounded-xl p-4 px-6 mb-8 flex items-center w-full md:w-[500px]",4,"ngIf"],["novalidate","",1,"space-y-8",3,"ngSubmit"],["for","titulo",1,"block","mb-2","text-2xl"],["type","text","id","titulo","name","titulo","minlength","3","required","",1,"w-full","max-w-none","md:max-w-[1424px]","border","border-black","rounded","px-4","py-3","text-xl",3,"ngModelChange","ngModel"],["class","text-red-600 text-sm mt-1",4,"ngIf"],["for","descripcion",1,"block","mb-2","text-2xl"],["id","descripcion","name","descripcion","minlength","10","required","",1,"w-full","max-w-none","md:max-w-[1424px]","border","border-black","rounded","px-4","py-3","text-xl","h-40","resize-none",3,"ngModelChange","ngModel"],["for","fechaLimite",1,"block","mb-2","text-2xl"],["type","date","id","fechaLimite","name","fechaLimite","required","",1,"w-64","border","border-black","rounded","px-4","py-3","text-xl",3,"ngModelChange","ngModel"],[1,"flex","flex-col","md:flex-row","gap-6","pt-4"],["type","submit",1,"flex-1","h-[60px]","bg-[#B225FE]","hover:opacity-90","text-white","text-xl","font-bold","rounded-[10px]","transition-opacity","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"disabled"],["type","button",1,"flex-1","h-[60px]","bg-white","border-2","border-black","text-xl","rounded-[10px]","hover:bg-gray-100",3,"click"],["type","button",1,"flex-1","h-[60px]","bg-white","border-2","border-black","text-xl","rounded-[10px]","hover:bg-red-100",3,"click"],[1,"hidden","md:flex","justify-center","items-start"],["src","/Megafono.png","alt","Meg\xE1fono",1,"w-64"],[1,"mb-4","flex","justify-center"],[1,"bg-pinkfigma","rounded-xl","p-4","px-6","mb-8","flex","items-center","w-full","md:w-[500px]"],[1,"w-8","h-8","bg-black","rounded-full","flex","items-center","justify-center","mr-4"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-white"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"text-black","font-medium"],[1,"bg-red-200","rounded-xl","p-4","px-6","mb-8","flex","items-center","w-full","md:w-[500px]"],[1,"text-red-800","font-medium"],[1,"text-red-600","text-sm","mt-1"]],template:function(o,n){if(o&1){let d=I();e(0,"div",4)(1,"div",5)(2,"h1",6),s(3,"Editar Convocatoria"),t(),g(4,J,3,3,"div",7)(5,K,6,1,"div",8)(6,Q,3,1,"div",9),e(7,"form",10,0),x("ngSubmit",function(){m(d);let r=f(8);return p(n.guardar(r))}),e(9,"div")(10,"label",11),s(11,"Titulo de la convocatoria"),t(),e(12,"input",12,1),_("ngModelChange",function(r){return m(d),C(n.titulo,r)||(n.titulo=r),p(r)}),t(),g(14,X,2,0,"p",13),t(),e(15,"div")(16,"label",14),s(17,"Descripci\xF3n"),t(),e(18,"textarea",15,2),_("ngModelChange",function(r){return m(d),C(n.descripcion,r)||(n.descripcion=r),p(r)}),t(),g(20,Y,2,0,"p",13),t(),e(21,"div")(22,"label",16),s(23,"Fecha Limite"),t(),e(24,"input",17,3),_("ngModelChange",function(r){return m(d),C(n.fechaLimite,r)||(n.fechaLimite=r),p(r)}),t()(),e(26,"div",18)(27,"button",19),s(28," Guardar cambios "),t(),e(29,"button",20),x("click",function(){return m(d),p(n.cancelar())}),s(30," Cancelar Cambios "),t(),e(31,"button",21),x("click",function(){return m(d),p(n.eliminar())}),s(32," Eliminar convocatoria "),t()()()(),e(33,"div",22),w(34,"img",23),t()()}if(o&2){let d=f(8),l=f(13),r=f(19);c(4),u("ngIf",n.mensajeAccion),c(),u("ngIf",n.mensaje),c(),u("ngIf",n.sinPropiedad),c(6),h("ngModel",n.titulo),c(2),u("ngIf",l.invalid&&l.touched),c(4),h("ngModel",n.descripcion),c(2),u("ngIf",r.invalid&&r.touched),c(4),h("ngModel",n.fechaLimite),c(3),u("disabled",d.invalid)}},dependencies:[V,k,G,U,R,P,W,q,z,B,D,A],encapsulation:2})};export{H as EditarConvocatoriaComponent};
