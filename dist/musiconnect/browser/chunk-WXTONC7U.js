import{a as D}from"./chunk-JCNJBNNY.js";import{a as A}from"./chunk-7OC2QND7.js";import{a as R}from"./chunk-Q4PFRBFB.js";import{Aa as M,B as f,Ba as j,F as s,Fa as B,I as d,K as h,Ma as y,O as c,Oa as F,R as p,Sa as T,T as I,U as n,V as r,W as v,Z as _,da as S,ea as u,fa as w,ga as l,ia as m,sa as E,u as x,v as b,wa as C}from"./chunk-H2FOQYQS.js";function V(i,t){if(i&1){let e=_();n(0,"div",14)(1,"button",15),S("click",function(){x(e);let o=u(2);return b(o.editarBanda())}),v(2,"img",16),r()()}}function P(i,t){if(i&1&&(n(0,"span"),l(1),r()),i&2){let e=u(3);I(e.tipoMensaje()==="success"?"text-sm text-green-600 font-medium px-3 py-1 bg-green-100 rounded-md":"text-sm text-red-600 font-medium px-3 py-1 bg-red-100 rounded-md"),s(),m(" ",e.mensajeSeguimiento()," ")}}function U(i,t){if(i&1){let e=_();n(0,"div",17)(1,"button",18),S("click",function(){x(e);let o=u(2);return b(o.seguirBanda())}),v(2,"img",19),r(),c(3,P,2,3,"span",20),r()}if(i&2){let e=u(2);s(3),p("ngIf",e.mensajeSeguimiento())}}function q(i,t){if(i&1&&(n(0,"li"),l(1),r()),i&2){let e=t.$implicit;s(),m(" ",e," ")}}function G(i,t){if(i&1&&(n(0,"li"),l(1),r()),i&2){let e=t.$implicit;s(),m(" ",e," ")}}function $(i,t){if(i&1&&(n(0,"div",2)(1,"section",3),v(2,"img",4),n(3,"h1",5),l(4),r(),c(5,V,3,0,"div",6)(6,U,4,1,"ng-template",null,0,E),n(8,"div",7)(9,"span",8),l(10),r(),n(11,"span",8),l(12),r()()(),n(13,"section",9)(14,"div")(15,"h2",10),l(16,"Descripci\xF3n"),r(),n(17,"p",11),l(18),r()(),n(19,"div")(20,"h2",10),l(21,"G\xE9neros musicales:"),r(),n(22,"ul",12),c(23,q,2,1,"li",13),r()(),n(24,"div")(25,"h2",10),l(26,"Miembros:"),r(),n(27,"ul",12),c(28,G,2,1,"li",13),r()()()()),i&2){let e=t.ngIf,a=w(7),o=u();s(4),m(" ",e.nombre," "),s(),p("ngIf",o.esAdmin())("ngIfElse",a),s(5),m(" Admin: ",e.administradorNombreArtistico," "),s(2),m(" G\xE9nero: ",o.generos.join(", ")," "),s(6),m(" ",e.descripcion||"Sin descripci\xF3n."," "),s(5),p("ngForOf",o.generos),s(5),p("ngForOf",o.listaMiembros)}}var N=class i{constructor(t,e,a,o,g){this.route=t;this.bandSvc=e;this.session=a;this.router=o;this.followSvc=g}banda=f(null);miembros=f([]);mensajeSeguimiento=f("");tipoMensaje=f("success");esAdmin=C(()=>{let t=this.session.getNombreArtistico();return t!==null&&this.banda()?.administradorNombreArtistico===t});ngOnInit(){let t=this.route.snapshot.paramMap.get("id"),e=t?+t:null;if(!e){this.router.navigate(["/home"]);return}this.bandSvc.obtenerBandaPorId(e).subscribe({next:a=>this.banda.set(a),error:()=>this.router.navigate(["/home"])}),this.bandSvc.obtenerMiembros(e).subscribe({next:a=>this.miembros.set(a),error:()=>{}})}editarBanda(){this.esAdmin()&&this.router.navigate(["/editar-banda",this.banda()?.bandId])}seguirBanda(){let t=this.session.getUserId(),e=this.banda();if(!t||!e)return;let a={followerId:t,followedBandId:e.bandId};this.followSvc.crearFollow(a).subscribe({next:o=>{this.tipoMensaje.set("success"),this.mensajeSeguimiento.set(o.message??"Ahora sigues la banda."),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)},error:o=>{let g=o?.error?.error;if(g&&g.includes("Ya sigues")){let O={followerId:t,followedBandId:e.bandId};this.followSvc.eliminarFollow(O).subscribe({next:k=>{this.tipoMensaje.set("error"),this.mensajeSeguimiento.set(k.message??"Dejaste de seguir la banda."),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)},error:()=>{this.tipoMensaje.set("error"),this.mensajeSeguimiento.set("Error al dejar de seguir la banda."),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)}})}else this.tipoMensaje.set("error"),this.mensajeSeguimiento.set(g??"Error al seguir banda."),setTimeout(()=>this.mensajeSeguimiento.set(""),3e3)}})}get generos(){return this.banda()?.generosMusicales??[]}get listaMiembros(){return this.miembros()}static \u0275fac=function(e){return new(e||i)(d(y),d(D),d(R),d(F),d(A))};static \u0275cmp=h({type:i,selectors:[["app-mostrar-banda"]],decls:1,vars:1,consts:[["iconoSeguir",""],["class","perfil-container flex flex-col md:flex-row gap-10 p-6 md:p-10 font-bree",4,"ngIf"],[1,"perfil-container","flex","flex-col","md:flex-row","gap-10","p-6","md:p-10","font-bree"],[1,"flex","flex-col","items-center","md:w-1/3"],["src","/Banda.png","alt","Imagen de la banda",1,"w-56","h-56","object-cover","rounded-md","border"],[1,"mt-4","text-xl","md:text-2xl","font-semibold"],["class","flex gap-6 mt-4",4,"ngIf","ngIfElse"],[1,"flex","gap-4","mt-4","text-sm","md:text-base"],[1,"px-3","py-1","rounded-full","bg-[#D9D9D9]","uppercase"],[1,"md:w-2/3","flex","flex-col","gap-6"],[1,"text-lg","md:text-xl","mb-2"],[1,"bg-[#ECECEC]","rounded","p-4","h-32","overflow-y-auto"],[1,"bg-[#ECECEC]","rounded","p-4","h-32","overflow-y-auto","list-disc","list-inside","space-y-1"],[4,"ngFor","ngForOf"],[1,"flex","gap-6","mt-4"],["aria-label","Editar banda",3,"click"],["src","/Edit.png","alt","Editar",1,"w-8","h-8","hover:scale-110","transition-transform"],[1,"flex","flex-col","items-center","gap-1","mt-2"],["aria-label","Seguir banda",3,"click"],["src","/Follow.png","alt","Seguir",1,"w-10","h-10","hover:scale-110","transition-transform"],[3,"class",4,"ngIf"]],template:function(e,a){e&1&&c(0,$,29,8,"div",1),e&2&&p("ngIf",a.banda())},dependencies:[B,M,j,T],encapsulation:2})};export{N as MostrarBandaComponent};
