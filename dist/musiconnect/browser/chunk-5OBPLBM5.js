import{a as T}from"./chunk-ETROT72L.js";import{a as k}from"./chunk-Q4PFRBFB.js";import{Ba as F,Ea as M,F as s,Fa as D,I as v,K as h,Ma as E,O as u,Oa as P,R as f,Sa as R,U as i,V as r,W as C,X as I,Y as _,Z as x,da as g,ea as l,ga as a,ha as b,ia as p,pa as S,ra as y,u as m,v as d,ya as w}from"./chunk-H2FOQYQS.js";function A(n,e){if(n&1){let t=x();i(0,"button",13),g("click",function(){m(t);let c=l(2);return d(c.editar())}),a(1,"Editar"),r()}}function O(n,e){if(n&1){let t=x();I(0),i(1,"div",1)(2,"div",2),u(3,A,2,0,"button",3),i(4,"img",4),g("click",function(){m(t);let c=l();return d(c.volver())}),r(),i(5,"div",5),C(6,"img",6),i(7,"div",7)(8,"h2",8),a(9),r(),i(10,"p",9),a(11),S(12,"date"),r(),i(13,"p",9),a(14),r()()(),i(15,"div",10)(16,"h3",11),a(17,"DESCRIPCI\xD3N:"),r(),i(18,"div",12),a(19),r()()()(),_()}if(n&2){let t=e.ngIf,o=l();s(3),f("ngIf",o.esPropia),s(6),b(t.titulo),s(2),p("Fecha l\xEDmite: ",y(12,5,t.fechaLimite,"dd/MM/yyyy"),""),s(3),p("Creador: ",t.creadorNombreArtistico,""),s(5),p(" ",t.descripcion," ")}}var N=class n{constructor(e,t,o,c){this.route=e;this.convocationService=t;this.session=o;this.router=c}convocatoria;cargando=!0;esPropia=!1;esFavorita=void 0;ngOnInit(){let e=+(this.route.snapshot.paramMap.get("id")??0),t=this.session.getUserId()??0;this.convocationService.obtenerPorId(e).subscribe({next:o=>{let c=this.esExpirada(o.fechaLimite);if(!o||c){this.router.navigate(["/listar-convocatorias"]);return}this.convocatoria=o,this.esPropia=this.session.getNombreArtistico()===o.creadorNombreArtistico,this.esPropia?this.cargando=!1:this.convocationService.listarFavoritasPorUsuario(t).subscribe({next:V=>{this.esFavorita=V.some(j=>j.convocationId===o.convocationId),this.cargando=!1},error:()=>this.cargando=!1})},error:()=>this.router.navigate(["/listar-convocatorias"])})}volver(){this.router.navigate(["/listar-convocatorias"])}editar(){this.convocatoria&&this.router.navigate(["/editar-convocatoria",this.convocatoria.convocationId])}toggleFavorito(){if(this.esPropia||!this.convocatoria)return;let e=this.session.getUserId()??0;this.esFavorita?this.convocationService.eliminarDeFavoritas({usuarioId:e,convocatoriaId:this.convocatoria.convocationId}).subscribe({next:()=>{this.esFavorita=!1}}):this.convocationService.marcarComoFavorita({usuarioId:e,convocatoriaId:this.convocatoria.convocationId}).subscribe({next:()=>{this.esFavorita=!0}})}fechaFormateada(){return this.convocatoria?w(this.convocatoria.fechaLimite,"dd/MM/yyyy","es-ES"):""}esExpirada(e){return(e.includes("T")?new Date(e):new Date(`${e}T23:59:59`)).getTime()<Date.now()}static \u0275fac=function(t){return new(t||n)(v(E),v(T),v(k),v(P))};static \u0275cmp=h({type:n,selectors:[["app-mostrar-convocatoria"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"px-4","py-8","flex","justify-center","font-bree"],[1,"w-[1121px]","h-[759px]","bg-[#D9D9D9]","relative","p-8","flex","flex-col"],["class","absolute top-6 left-6 bg-[#000784] text-white px-6 py-2 rounded-[15px]",3,"click",4,"ngIf"],["src","/Retroceder.png","alt","Volver",1,"absolute","top-6","right-6","w-8","h-8","cursor-pointer",3,"click"],[1,"flex","gap-10","mt-10"],["src","/FotoPerfil.png","alt","Perfil",1,"w-64","h-64","object-cover"],[1,"flex-1","space-y-4"],[1,"text-3xl","font-black"],[1,"text-xl"],[1,"mt-10"],[1,"text-2xl","font-black","mb-4"],[1,"bg-[#F1F1F1]","p-6","rounded-xl","whitespace-pre-line","overflow-y-auto"],[1,"absolute","top-6","left-6","bg-[#000784]","text-white","px-6","py-2","rounded-[15px]",3,"click"]],template:function(t,o){t&1&&u(0,O,20,8,"ng-container",0),t&2&&f("ngIf",o.convocatoria)},dependencies:[D,F,M,R],encapsulation:2})};export{N as MostrarConvocatoriaComponent};
